---
editor: 
  markdown: 
    wrap: 80
bibliography: this.bib
---

\newcommand{\mupre}{\mu_\mathrm{pre}}
\newcommand{\mupost}{\mu_\mathrm{post}}
\newcommand{\sigmapre}{\sigma_\mathrm{pre}}
\newcommand{\sigmapost}{\sigma_\mathrm{post}}

\newcommand{\thetafit}{\theta^\mathrm{fit}}

\newcommand{\fdr}{\mathrm{FDR}}

\newcommand{\meanobs}{\bar{o}}
\newcommand{\meanobsemp}{\bar{\mathbf{o}}}
\newcommand{\meanobst}{\meanobs_t}
\newcommand{\meanobsjt}{\meanobs_{j,t}}
\newcommand{\meanobspre}{\meanobs_\mathrm{pre}}
\newcommand{\meanobspost}{\meanobs_\mathrm{post}}
\newcommand{\tpre}{t_\mathrm{pre}}
\newcommand{\tpost}{t_\mathrm{post}}

# Method

A group polarization replication is proven undecidable, and therefore not truly
a replication, if we can find a model of *mere agreement* that appears to be
polarized under that replication's experimental design. If we cannot find such a
model, we cannot determine a replication to be undecidable. Mere agreement in
this model is a dynamic where agreement increases within the group, but
extremism does not—in other words, A *null-polarization distributions* is a set
of two Gaussian distributions: one representing the pre-discussion opinions of
the group, and the other representing the post-discussion opinions. Our
*null-polarization distributions* represent the process of the group finding
*mere agreement*, which is when the average group opinion is constant over time,
but opinion variance decreases to represent agreement (or, equivalently,
*consensus* [@DeGroot1974]).

Null-polarization We thus model opinions at each time, $t=\mathrm{pre}$ and
$t=\mathrm{post}$, as random variables drawn from a normal distribution with
mean $\mu_t$ and standard deviation $\sigma_t$. we drop the time

The null-polarization distributions are represented by $\nu$.

in a simple, general way---i.e., a decrease in opinion variance but a static
opinion mean---we represent . In the general group polarization hypothesis, the
group is assumed to start out mostly agreeing in principle (i.e., mostly all
agree or disagree) but to different extremes. After discussion

Showing a replication is undecidable is sufficient to undermine it. However, it
does not tell us what is the probability that a particular experimental design
produces false positives, due to clipping or any other problem.

## Simulation of Mere Consensus and Opinion Change Measurement

We model \emph{mere consensus} and opinion change measurement in group
polarization experiments to examine whether published replications can be
explained by this particular null polarization model. We simulate consensus and
measurement two ways for complementary purposes. First is this *expectation*
model, and the second is the *stochastic* model. Both models assume group
opinions are normally distributed, which is practical due to its simplicity.

We assume that participants' true latent opinions at some time, $t$, are random
variables drawn from a normal distribution with mean $\mu_t$ and standard
deviation $\sigma_t$. A normal distribution is scientifically justifiable, since
opinions are aggregations of many constituent electrical and chemical signals in
the brain—the distribution of aggregations like this tend to be *normal* (hence
the name). A normal distribution also makes sense because several of the
analysis procedures from the corpus use a $t$-test or other basic linear
regression-style test, which implicitly assume data are distributed normally.

The two models differ in how they simulate opinions, opinion change, and opinion
change measurement. We use the *expectation model* as a computationally
efficient way to simulate the observed mean opinion as the mathematical
*expectation value* of the distribution of measured opinions. In the second
model, the *stochastic model*, we simulate participant survey reporting as
drawing a latent opinion from the latent opinion distribution, then binning that
opinion in the associated opinion bin. We use the expectation model for its
efficiency in the first step of our analysis: to find a *null-polarization
model* that also fits the data for each experimental condition studied—if we
find one that means we must retract this replication since this proves that the
group polarization is undecidable with the data we have. Once we find any such
undecidable results, we use the null-polarization model to help us further
evaluate the experimental design itself.

In the *stochastic model*, we simulate group polarization data for the
*Evaluation* step of the analysis. We simulate experimental data, with the same
number of participants as the original experiment, using the null-polarization
model found in the *Identification* step, if one was found.

We *evaluate* the experimental design, $e$, in terms of the false positive rate,
also known as the Type I error rate or family-wise error rate, denoted
$\alpha_e$. We close our analysis by demonstrating how our method can be
inverted to *evaluate* experimental designs in the pre-registration stage to
avoid preventable replication failures like we identify here.

### Latent Opinion Model

Throughout this paper we model a participant $i$'s latent opinion at time $t$ as
a normally-distributed random variable,

$$ 
\omega_{i,t} \sim
\mathcal{N}(\mu_t, \sigma_t).  
$$
Group polarization in latent opinions is defined as any pair of pre- and
post-discussion opinion distributions where the mean increases in magnitude over
time—formally this is $| \mupre | < | \mupost |$. We need to take magnitudes since radicalization may be towards increasingly negative or positive opinion values. 

For group polarization experiments, only two times are relevant:
*pre-discussion*, $t=\mathrm{pre}$, and *post-discussion*, $t=\mathrm{post}$. Since participant groups are assumed to be likeminded, we could also assume they come to agree more over time as well as become more extreme in our group polarization model, or in terms of the latent opinion variance, $\sigmapre > \sigmapost$—but only one study in our ten actually measured opinion variance to check this [@Schkade2010].

A *null-polarization hypothesis*, or *model*, is one where the latent mean stays
constant, i.e. $\mu = \mu_\mathrm{pre} = \mu_\mathrm{post}$. *Mere agreement* is
one type of null-polarization model, 
the variance decreases over time to model agreement as described above. The mere agreement model is the cornerstone of our analysis, since it is empirically plausible and generates *spurious* observations of group polarization under mere agreement models, due to measurement artifacts induced by clipping all latent opinion values outside the measurement range—we call this *spurious polarization* for short. We simulate opinion measurements in two different ways, but both use the mere agreement model of latent opinions to test whether and by how much the measurement procedure distorts null-polarization to look like group polarization.

::: {style="text-align: center;"}
\[ TABLE \[tab:latent-variables\](#tab:latent-variables){reference-type="ref"
reference="tab:latent-variables"} ABOUT HERE \]
:::

### The Expectation Model of Opinion Measurement

We use the \emph{expectation model} of opinion measurement to \emph{Identify} which, if any, mere agreement null-polarization models generate spurious group polarization in a particular experiment, $e$. The trick to this model, and the source of its name, is that we equate the theoretical \emph{expected value} of opinion measurements with the simulated \emph{observed average} of participant opinions. 


We simulate the measurement of the mean observed opinion at time $t$ 
by first calculating integrating the normal probability density function over measurement bin boundaries $f(\omega)$, over each bin's corresponding range of opinion values. For example, consider an ordinal scale  that runs from -3 (strongly disagree) to +3 (strongly agree) (as
used by @Moscovici1969, for example). the frequency with which the "2" bin is
chosen is just the total area underneath the probability density curve between
1.5 and 2.5. 

All bins have a width of 1 in latent opinion space, except for the two most
extreme bins at opposite ends of the sentiment spectrum---this works because bin
values are always separated by 1. All continuous latent opinion values
$\omega < b_1 + \frac{1}{2} = \theta_1$ get mapped to the ordinal measurement
value $b_1$---so, $b_1$'s lower threshold is $\theta_0 = -\infty$. Similarly,
all opinions $\omega > b_B - 0.5 = \theta_B$ are reported as the maximum bin
value, $b_B$, with an effective upper bound of $\theta_{B+1} = +\infty$. We can
define all thresholds compactly as [@Liddell2018] 
$$
\theta_j = \begin{cases}
  -\infty         & \text{ if } j=0 \\
  \infty          & \text{ if } j=B \\
  b_j + \frac{1}{2} & \text{ otherwise.}
\end{cases}
$$

The probability density that a participant reports the opinion in bin index $i$ at time $t$ is
$$
f_{it}(\mu, \sigma_t) = \int_{\theta_{i - 1}}^{\theta_{i}} f(\omega; \mu, \sigma_t)~d\omega,
$$
which we calculated in R to evaluate the integral at the two threshold values $\theta_{i-1}$ and $\theta_i$. Note that the normal probability density function we used is parameterized by mean $\mu$ and standard deviation $\sigma_t$.
$$
f(\omega; \mu, \sigma_t) = 
    \frac{1}{\sigma_t \sqrt{2 \pi}} e^{-\frac{(\omega - \mu)^2}{2 \sigma_t^2}}.
$$ 

To simulate the measurement of the *average* observed opinion at time $t$, $\bar{o}_t$, as the expected value of the probability density function of observed ordinal opinions. In other words, we simulate $\bar{o}_t$ by calculating the weighted sum of products between the probability of observing each bin value and the bin value itself:
$$
\bar{o}_t(\nu, e) = \sum_{i=1}^B b_i f_{it}(\nu, e).
$${#eq-sim-ave-observed}

Group polarization is the difference between the post-deliberation mean observed
opinion and the pre-deliberation one. We will calculate the magnitude of spurious group polarization under a mere agreement null model represented by its collected distribution parameters, $\nu = (\mu, \sigmapre, \sigmapost)$, under experimental design, $e$: 
$$
g(\nu, e) = |\bar{o}_\mathrm{post}(\nu, e)| - |\bar{o}_\mathrm{pre}(\nu, e)|
$${#eq-spurious-gp}

In the *Inspect* stage of our analysis we will determine which group polarization replications are invalidated due to equifinality between the *mere agreement null-polarization hypothesis* on the one hand, and the *group polarization hypothesis*
on the other. This requires more than just showing there is some $\nu$ that causes spurious polarization for some experiment where $g(\nu, e) > 0$. We have to find a $\nu$ that generates the exact $g(\nu, e)$ reported in the original journal article *and* check that simulated $\bar{o}_\mathrm{pre}$ and $\bar{o}_\mathrm{pre}$ match published values.

::: {text-align="center"}
\[ TABLE
[\[tab:experiment-parameters\]](#tab:experiment-parameters){reference-type="ref"
reference="tab:experiment-parameters"} ABOUT HERE \]
:::

::: center
\[ TABLE
[\[tab:simulated-observations\]](#tab:simulated-observations){reference-type="ref"
reference="tab:simulated-observations"} ABOUT HERE \]
:::

#### Example: the "Americans" condition in Moscovici and Zavalloni (1969)

One of the replications we invalidate here is from Moscovici and Zavalloni (1969),
the "Americans" condition as they called it—we coded it `Moscovici1969_Americans`. 
They report that participant opinions polarized after discussing the survey topic, "American economic aid is always used for political pressure." They report survey 
responses increased in extremity from an average of -0.9 before discussion to
-1.6 after, on a seven-bin scale
from -3 indicating "strongly disagree" to +3 indicating "strongly agree".

Moscovici and Zavalloni say their results confirm the basic hypothesis, that \emph{group discussion causes polarization}. But we found a mere agreement null-polarization model that generates spurious group polarization using our model—specifically, $\nu = (\mu = -1.2, \sigma_\mathrm{pre}= 4.3, and \sigma_\mathrm{post}= 1.9)$. This means that the hypothesis is actually undecidable given the data, invalidating Moscovici and Zavalloni's replication.
When a hypothesis and its null explain data equally well, the data tell us nothing.

Now let's use the expectation model to prove that this $\nu$ generates spurious group polarization in this experiment, i.e., $g(\nu, e= \mathrm{Moscovici1969\_Americans}) > 0$. 
In the process we demonstrate how the expectation model works to simulate the measurement of spurious group polarization (@eq-spurious-gp). 

First, we calculate the probability density vector using the [`makeProbVec`](https://github.com/mt-digital/gp-statmod/blob/main/GroupPolarizationStatmod/model.R#L44) function in the file [`GroupPolarizationStatmod/model.R`](https://github.com/mt-digital/gp-statmod/blob/main/GroupPolarizationStatmod/model.R) in the [project code repository on GitHub](https://github.com/mt-digital/gp-statmod) for both experiment times: pre- and post-discussion:
$$
f_\mathrm{pre} = 
\begin{pmatrix}
  0.38 & 0.09 & 0.09 & 0.09 & 0.08 & 0.07 & 0.19
\end{pmatrix}
$$ 
and
$$
f_\mathrm{post} = \
\begin{pmatrix} 
0.25 & 0.19 & 0.21 & 0.17 & 0.11 & 0.05 & 0.03 
\end{pmatrix}.
$$

When we plug in the bin values and copmuted $f_\mathrm{pre}$ values into the simulated average pre-discussion opinion definition (@eq-sim-ave-observed),
$$
\bar{o}_\mathrm{pre} = -3 \cdot 0.38~~+-2\cdot 0.09~~+\ldots+3\cdot0.19 = -0.6
$$
$$
\bar{o}_\mathrm{post} = -3 \cdot 0.25~~+-2\cdot 0.19~~+\ldots+3\cdot0.03 = -1.04
$$
So, we find that for the `Moscovici1969_Americans`, our null-polarization model appears polarized, with the exact same average pre- and post-discussion opinions reported by Moscovici and Zavalloni (1969), and the same magnitude of radicalization (CHECK THE PRESENTATION OF ALL THREE ABOVE)
$$
g(\nu, e) = \bar{o}_\mathrm{post} - \bar{o}_\mathrm{pre} = -1.04 - (-0.6) = - 0.4.
$$
::: {style="text-align: center;"}
FIGURE [\[fig:distros\]](#fig:distros){reference-type="ref"
reference="fig:distros"} ABOUT HERE 
:::

The replication of the `Moscovici1969_Americans` experimental condition is therefore invalidated since we proved equifinality between the group polarization hypothesis 
(discussion induces polarization) and its null (discussion does not induce polarization). \emph{If the null fits, we must omit} the result from the set of results supporting any particular hypothesis. Therefore, despite being cited over 1,000 times as a replication, these citations are in fact erroneous—even if powerful authors hold them up as such. 

But how did we actually \emph{find} the null-polarization model that generated spurious group polarization? Below we demonstrate how we use a stochastic descent-style root finding that calculates spurious group polarization for a given $\nu$, then takes a step in a random direction, biased towards the direction of less error. It is therefore essential to use this efficient calculation simulation method, since tens, hundreds, or more evaluations are required for this root-finding algorithm. We show exactly how we put this to work in the following subsection explaining the algorithm to finish the \emph{Identification} step of our analysis.


<!-- OLD STUFF BELOW BEFORE QMD REWRITE -->
<!-- Moscovici and Zavalloni report -->
<!-- (Figure [\[fig:distros\]](#fig:distros){reference-type="ref" -->
<!-- reference="fig:distros"}). First, calculate the vector of probability density -->
<!-- values for each bin, $f[b]$, for the pre- and post-discussion latent opinion -->
<!-- distributions using Equation [\[eq:\]](#eq:){reference-type="ref" -->
<!-- reference="eq:"} (calculated with -->
<!-- \['makeProbVec'\](https://github.com/mt-digital/gp-statmod/blob/final-draft/GroupPolarizationStatmod/model.R#L43) -->
<!-- from the \[project code -->
<!-- repository\](https://github.com/mt-digital/gp-statmod/tree/final-draft/GroupPolarizationStatmod) -->
## Root-finding Algorithm to Find Null-Polarization Models with Artifacts

## Corpus Analysis to Determine Undecidable Replications

To analyze published replications we need to expand our notation to index
individual *experiments* with replications, and from which different journal
articles, track and analyze it,

## Evaluating Grouop Polarization Experimental Designs
